/*!
*  filename: ej2-kanban.min.js
*  version : 17.4.47
*  Copyright Syncfusion Inc. 2001 - 2019. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
this.ej=this.ej||{},this.ej.kanban=function(e,t,n,a,r){"use strict";var l="content-ready",o="data-ready",i=function(){function e(e){this.parent=e,this.initDataManager(e.dataSource,e.query),this.refreshDataManager()}return e.prototype.initDataManager=function(e,t){this.dataManager=e instanceof a.DataManager?e:new a.DataManager(e),this.query=t instanceof a.Query?t:new a.Query},e.prototype.generateQuery=function(){return this.query.clone()},e.prototype.getData=function(e){return this.dataManager.executeQuery(e)},e.prototype.refreshDataManager=function(){var e=this;this.getData(this.generateQuery()).then(function(t){return e.dataManagerSuccess(t)}).catch(function(t){return e.dataManagerFailure(t)})},e.prototype.dataManagerSuccess=function(e){var n=this;this.parent.isDestroyed||this.parent.trigger("dataBinding",e,function(e){var a=t.extend([],e.result,null,!0);n.parent.kanbanData=a,n.parent.notify(o,{processedData:a}),n.parent.trigger("dataBound",null,function(){return n.parent.hideSpinner()})})},e.prototype.dataManagerFailure=function(e){var t=this;this.parent.isDestroyed||this.parent.trigger("actionFailure",{error:e},function(){return t.parent.hideSpinner()})},e}(),s=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),d=function(e,t,n,a){var r,l=arguments.length,o=l<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(o=(l<3?r(o):l>3?r(t,n,o):r(t,n))||o);return l>3&&o&&Object.defineProperty(t,n,o),o},c=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return s(n,e),d([t.Property()],n.prototype,"keyField",void 0),d([t.Property()],n.prototype,"textField",void 0),d([t.Property(!1)],n.prototype,"showEmptyRow",void 0),d([t.Property(!0)],n.prototype,"showItemCount",void 0),d([t.Property(!1)],n.prototype,"allowDragAndDrop",void 0),d([t.Property()],n.prototype,"template",void 0),d([t.Property("Ascending")],n.prototype,"sortBy",void 0),n}(t.ChildProperty),p=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),h=function(e,t,n,a){var r,l=arguments.length,o=l<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(o=(l<3?r(o):l>3?r(t,n,o):r(t,n))||o);return l>3&&o&&Object.defineProperty(t,n,o),o},u=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return p(n,e),h([t.Property(!0)],n.prototype,"showHeader",void 0),h([t.Property()],n.prototype,"headerField",void 0),h([t.Property()],n.prototype,"contentField",void 0),h([t.Property()],n.prototype,"template",void 0),h([t.Property("Single")],n.prototype,"selectionType",void 0),n}(t.ChildProperty),m=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),g=function(e,t,n,a){var r,l=arguments.length,o=l<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(o=(l<3?r(o):l>3?r(t,n,o):r(t,n))||o);return l>3&&o&&Object.defineProperty(t,n,o),o},y=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return m(n,e),g([t.Property()],n.prototype,"keyField",void 0),g([t.Property()],n.prototype,"headerText",void 0),g([t.Property()],n.prototype,"template",void 0),g([t.Property(!1)],n.prototype,"allowToggle",void 0),g([t.Property(!0)],n.prototype,"isExpanded",void 0),g([t.Property()],n.prototype,"minCount",void 0),g([t.Property()],n.prototype,"maxCount",void 0),g([t.Property(!1)],n.prototype,"showItemCount",void 0),n}(t.ChildProperty),f=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),v=function(e,t,n,a){var r,l=arguments.length,o=l<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(o=(l<3?r(o):l>3?r(t,n,o):r(t,n))||o);return l>3&&o&&Object.defineProperty(t,n,o),o},w=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return f(n,e),v([t.Property()],n.prototype,"text",void 0),v([t.Property()],n.prototype,"keyFields",void 0),n}(t.ChildProperty),C="e-kanban-content",b=function(){function e(e){this.parent=e,this.swimlaneToggleArray=[],this.columnToggleArray=[],this.selectionArray=[],this.lastCardSelection=null,this.lastSelectionRow=null,this.lastCard=null,this.selectedCardsElement=[],this.selectedCardsData=[],this.hideColumnKeys=[]}return e.prototype.cardClick=function(e){var n=this,a=t.closest(e.target,".e-card"),r=this.parent.getCardDetails(a);this.parent.activeCardData={data:r,element:a};var l={data:r,element:a,cancel:!1};this.parent.trigger("cardClick",l,function(t){t.cancel||n.cardSelection(a,e.ctrlKey,e.shiftKey)})},e.prototype.cardDoubleClick=function(e){var n=t.closest(e.target,".e-card"),a=this.parent.getCardDetails(n);this.parent.activeCardData={data:a,element:n};var r={data:a,element:n,cancel:!1};this.parent.trigger("cardDoubleClick",r)},e.prototype.rowExpandCollapse=function(e){var n=this,a={cancel:!1,target:e.target,requestType:"rowExpandCollapse"};this.parent.trigger("actionBegin",a,function(a){if(!a.cancel){var r=t.closest(e.target,".e-swimlane-row"),o=n.parent.element.querySelector(".e-content-row:nth-child("+(r.rowIndex+2)+")"),i=r.querySelector(".e-swimlane-row-expand,.e-swimlane-row-collapse");r.classList.contains("e-collapsed")?(t.removeClass([o,r],"e-collapsed"),t.classList(i,["e-swimlane-row-expand"],["e-swimlane-row-collapse"]),n.swimlaneToggleArray.splice(n.swimlaneToggleArray.indexOf(r.getAttribute("data-key")),1)):(t.addClass([o,r],"e-collapsed"),t.classList(i,["e-swimlane-row-collapse"],["e-swimlane-row-expand"]),n.swimlaneToggleArray.push(r.getAttribute("data-key"))),n.parent.notify(l,{}),n.parent.trigger("actionComplete",{target:e.target,requestType:"rowExpandCollapse"})}})},e.prototype.columnExpandCollapse=function(e){var n=this,a=e instanceof HTMLElement?e:e.target,r={cancel:!1,target:a,requestType:"columnExpandCollapse"};this.parent.trigger("actionBegin",r,function(e){if(!e.cancel){var r=t.closest(a,".e-header-cells"),o=r.cellIndex;n.columnToggle(r);var i=n.parent.element.querySelectorAll(".e-header-cells.e-collapsed").length;if(i===n.parent.columns.length-n.hideColumnKeys.length){var s=".e-header-cells:not(.e-stacked-header-cell):nth-child("+((o+1===i?0:o+1)+1)+")",d=n.parent.element.querySelector(s);t.addClass([d],"e-collapsed"),n.columnToggle(d)}n.parent.notify(l,{}),n.parent.trigger("actionComplete",{target:a,requestType:"columnExpandCollapse"})}})},e.prototype.columnToggle=function(e){var n=this,a=e.cellIndex,r=e.querySelector(".e-limits"),l=[].slice.call(this.parent.element.querySelectorAll(".e-content-row:not(.e-swimlane-row)")),o=".e-header-table col:nth-child("+(a+1)+"),.e-content-table col:nth-child("+(a+1)+")",i=e.querySelector(".e-column-expand,.e-column-collapse"),s=[].slice.call(this.parent.element.querySelectorAll(o));if(e.classList.contains("e-collapsed")){t.removeClass(s,"e-collapsed"),this.parent.isAdaptive&&s.forEach(function(e){e.style.width=t.formatUnit(n.parent.layoutModule.getWidth())}),t.classList(i,["e-column-expand"],["e-column-collapse"]);for(var d=0,c=l;d<c.length;d++){var p=(m=c[d]).querySelector(".e-content-cells:nth-child("+(a+1)+")");t.removeClass([p,e],"e-collapsed"),t.remove(p.querySelector(".e-collapse-header-text")),(f=p.querySelector(".e-limits"))&&t.removeClass([f],"e-hide-limits")}this.columnToggleArray.splice(this.columnToggleArray.indexOf(e.getAttribute("data-key")),1),r&&t.removeClass([r],"e-hide-limits"),this.parent.columns[a].setProperties({isExpanded:!0},!0)}else{t.addClass(s,"e-collapsed"),this.parent.isAdaptive&&s.forEach(function(e){e.style.width=t.formatUnit(50)}),t.classList(i,["e-column-collapse"],["e-column-expand"]);for(var h=0,u=l;h<u.length;h++){var m=u[h],g=e.getAttribute("data-key"),y=(p=m.querySelector('.e-content-cells[data-key="'+g+'"]')).cellIndex;p.appendChild(t.createElement("div",{className:"e-collapse-header-text",innerHTML:this.parent.columns[y].headerText})),t.addClass([p,e],"e-collapsed");var f=p.querySelector(".e-limits");f&&t.addClass([f],"e-hide-limits")}r&&t.addClass([r],"e-hide-limits"),this.columnToggleArray.push(e.getAttribute("data-key")),this.parent.columns[a].setProperties({isExpanded:!1},!0)}},e.prototype.cardSelection=function(e,n,a){var r=this;if(e){var l=this.parent.getSelectedCards();if("None"!==this.parent.cardSettings.selectionType){var o=t.closest(e,".e-content-row");if((t.isNullOrUndefined(this.lastSelectionRow)?o.rowIndex:this.lastSelectionRow.rowIndex)!==o.rowIndex&&(n||a)&&"Multiple"===this.parent.cardSettings.selectionType)return;if(0===l.length||n&&"Single"!==this.parent.cardSettings.selectionType||(t.removeClass(l,"e-selection"),l.forEach(function(e){r.selectionArray.splice(r.selectionArray.indexOf(e.getAttribute("data-id")),1),r.selectedCardsElement.splice(r.selectedCardsElement.indexOf(e),1),r.selectedCardsData.splice(r.selectedCardsData.indexOf(r.parent.getCardDetails(e),1))})),l.length>0&&a&&"Multiple"===this.parent.cardSettings.selectionType){var i=[],s=void 0,d=void 0,c=void 0,p=[].slice.call(o.querySelectorAll(".e-card"));p.forEach(function(e){return i.push(e.getAttribute("data-id"))});var h=e.getAttribute("data-id"),u=this.lastCard.getAttribute("data-id"),m=d=i.indexOf(h),g=s=i.indexOf(u),y=m>g?"next":"prev";for("prev"===y&&(s=m,d=g),c=s;c<=d;c++){var f=p[c];t.addClass([f],"e-selection"),this.selectionArray.push(f.getAttribute("data-id")),this.selectedCardsElement.push(f),this.selectedCardsData.push(this.parent.getCardDetails(f)),this.lastCardSelection=f,"prev"===y&&(this.lastCardSelection=p[s])}}else t.addClass([e],"e-selection"),this.selectionArray.push(e.getAttribute("data-id")),this.selectedCardsElement.push(e),this.selectedCardsData.push(this.parent.getCardDetails(e)),this.lastCard=this.lastCardSelection=e,this.lastSelectionRow=t.closest(e,".e-content-row")}}},e.prototype.addColumn=function(e,t){this.parent.columns.splice(t,0,e),this.parent.notify(o,{processedData:this.parent.kanbanData})},e.prototype.deleteColumn=function(e){var t=this.parent.element.querySelectorAll(".e-header-cells").item(e);t&&t.classList.contains("e-toggle-header")&&this.columnToggleArray.splice(this.columnToggleArray.indexOf(t.getAttribute("data-key"),0)),this.parent.columns.splice(e,1),0===this.parent.columns.length?this.parent.destroy():this.parent.notify(o,{processedData:this.parent.kanbanData})},e.prototype.showColumn=function(e){var t=this.hideColumnKeys.indexOf(e);-1!==t&&(this.hideColumnKeys.splice(t,1),this.parent.notify(o,{processedData:this.parent.kanbanData}))},e.prototype.hideColumn=function(e){this.hideColumnKeys.push(e),this.parent.notify(o,{processedData:this.parent.kanbanData})},e}(),S=function(){function e(e){this.parent=e,this.keyField=this.parent.cardSettings.headerField}return e.prototype.getQuery=function(){return this.parent.dataModule.generateQuery()},e.prototype.getTable=function(){return this.parent.query?this.parent.query.clone().fromTable:null},e.prototype.refreshData=function(e){var t=this,n={requestType:e.requestType,cancel:!1,addedRecords:e.addedRecords,changedRecords:e.changedRecords,deletedRecords:e.deletedRecords};this.parent.dataModule.dataManager.dataSource.offline?this.parent.trigger("actionComplete",n,function(e){e.cancel||t.parent.dataModule.refreshDataManager()}):e.promise.then(function(e){t.parent.isDestroyed||t.parent.trigger("actionComplete",n,function(e){e.cancel||t.parent.dataModule.refreshDataManager()})}).catch(function(e){t.parent.isDestroyed||t.parent.trigger("actionFailure",{error:e})})},e.prototype.addCard=function(e){var t=this,n={cancel:!1,requestType:"cardCreate",addedRecords:e instanceof Array?e:[e],changedRecords:[],deletedRecords:[]};this.parent.trigger("actionBegin",n,function(n){if(!n.cancel){var a=null,r={addedRecords:e instanceof Array?e:[e],changedRecords:[],deletedRecords:[]},l={requestType:"cardCreated",cancel:!1,promise:a=e instanceof Array?t.parent.dataModule.dataManager.saveChanges(r,t.keyField,t.getTable(),t.getQuery()):t.parent.dataModule.dataManager.insert(e,t.getTable(),t.getQuery()),addedRecords:r.addedRecords,changedRecords:r.changedRecords,deletedRecords:r.deletedRecords};t.refreshData(l)}})},e.prototype.updateCard=function(e){var t=this,n={requestType:"cardChange",cancel:!1,addedRecords:[],changedRecords:e instanceof Array?e:[e],deletedRecords:[]};this.parent.trigger("actionBegin",n,function(n){if(!n.cancel){var a=null,r={addedRecords:[],changedRecords:e instanceof Array?e:[e],deletedRecords:[]},l={requestType:"cardChanged",cancel:!1,promise:a=e instanceof Array?t.parent.dataModule.dataManager.saveChanges(r,t.keyField,t.getTable(),t.getQuery()):t.parent.dataModule.dataManager.update(t.keyField,e,t.getTable(),t.getQuery()),addedRecords:r.addedRecords,changedRecords:r.changedRecords,deletedRecords:r.deletedRecords};t.refreshData(l)}})},e.prototype.deleteCard=function(e){var t=this,n={addedRecords:[],changedRecords:[],deletedRecords:[]};n.deletedRecords="string"==typeof e||"number"==typeof e?this.parent.kanbanData.filter(function(n){return n[t.keyField]===e}):e instanceof Array?e:[e];var a={requestType:"cardRemove",cancel:!1,addedRecords:[],changedRecords:[],deletedRecords:n.deletedRecords};this.parent.trigger("actionBegin",a,function(a){if(!a.cancel){var r=null,l={requestType:"cardRemoved",cancel:!1,promise:r=n.deletedRecords.length>1?t.parent.dataModule.dataManager.saveChanges(n,t.keyField,t.getTable(),t.getQuery()):t.parent.dataModule.dataManager.remove(t.keyField,e,t.getTable(),t.getQuery()),addedRecords:n.addedRecords,changedRecords:n.changedRecords,deletedRecords:n.deletedRecords};t.refreshData(l)}})},e}(),E=function(){function e(e){this.parent=e,this.dragObj={element:null,cloneElement:null,targetClone:null,draggedClone:null,targetCloneMulti:null,selectedCards:[],pageX:0,pageY:0,navigationInterval:null,cardDetails:[]},this.dragEdges={left:!1,right:!1,top:!1,bottom:!1}}return e.prototype.wireDragEvents=function(e){new t.Draggable(e,{clone:!0,enableTapHold:this.parent.isAdaptive,enableTailMode:!0,cursorAt:{top:-10,left:-10},dragArea:this.parent.element.querySelector("."+C),dragStart:this.dragStart.bind(this),drag:this.drag.bind(this),dragStop:this.dragStop.bind(this),enableAutoScroll:!1,helper:this.dragHelper.bind(this)})},e.prototype.dragHelper=function(e){this.dragObj.element=e.element,this.dragObj.element.style.width=t.formatUnit(this.dragObj.element.offsetWidth);var n=t.createElement("div",{innerHTML:this.dragObj.element.outerHTML});return this.dragObj.cloneElement=n.childNodes.item(0),t.addClass([this.dragObj.cloneElement],["e-cloned-card","duplicate"]),this.dragObj.element.parentElement.appendChild(this.dragObj.cloneElement),this.dragObj.targetCloneMulti=t.createElement("div",{className:"e-target-multi-clone"}),this.dragObj.targetClone=t.createElement("div",{className:"e-target-dropped-clone",styles:"width:"+t.formatUnit(this.dragObj.element.offsetWidth)+";height:"+t.formatUnit(this.dragObj.element.offsetHeight)}),this.dragObj.cloneElement},e.prototype.dragStart=function(e){var n=this;if(this.dragObj.selectedCards=this.dragObj.element,this.dragObj.element.classList.contains("e-selection")){var a=t.closest(this.dragObj.element,".e-content-row");this.dragObj.selectedCards=[].slice.call(a.querySelectorAll(".e-card.e-selection:not(.duplicate)")),this.dragObj.selectedCards.forEach(function(e){n.dragObj.cardDetails.push(n.parent.getCardDetails(e))})}else this.dragObj.cardDetails=[this.parent.getCardDetails(this.dragObj.element)];var r={cancel:!1,data:this.dragObj.cardDetails,event:e,element:this.dragObj.selectedCards};this.parent.trigger("dragStart",r,function(e){if(e.cancel)return n.removeElement(n.dragObj.cloneElement),void(n.dragObj={element:null,cloneElement:null,targetClone:null,draggedClone:null,targetCloneMulti:null});if(n.dragObj.element.classList.contains("e-selection")){if(n.dragObj.selectedCards.forEach(function(e){n.draggedClone(e)}),n.dragObj.selectedCards.length>1){n.dragObj.cloneElement.innerHTML="";var a=t.createElement("div",{className:"e-multi-card-text",innerHTML:n.dragObj.selectedCards.length+" Cards"});n.dragObj.cloneElement.appendChild(a),t.classList(n.dragObj.cloneElement,["e-multi-card-clone"],["e-selection"]),n.dragObj.cloneElement.style.width="90px"}}else n.draggedClone(n.dragObj.element);n.parent.notify(l,{})})},e.prototype.draggedClone=function(e){this.dragObj.draggedClone=t.createElement("div",{className:"e-target-dragged-clone",styles:"width:"+t.formatUnit(e.offsetWidth-1)+";height:"+t.formatUnit(e.offsetHeight)}),e.insertAdjacentElement("afterend",this.dragObj.draggedClone),t.addClass([e],"e-kanban-dragged-card")},e.prototype.drag=function(e){var n=this;if(e.target){var a=t.closest(e.target,".e-card")||e.target,r=t.closest(a,".e-content-row:not(.e-swimlane-row) .e-content-cells");if(this.calculateArgs(e),r){var o=this.getColumnKey(r),i=o.split(",");this.multiCloneRemove();var s=!1;if(o===this.getColumnKey(t.closest(this.dragObj.draggedClone,".e-content-cells"))&&(s=!0),1===i.length||s)if(a.classList.contains("e-card")){var d=t.isNullOrUndefined(a.previousElementSibling)?"beforebegin":"afterend";a.insertAdjacentElement(d,this.dragObj.targetClone)}else a.classList.contains("e-content-cells")&&!t.closest(a,".e-swimlane-row")?a.querySelector(".e-card-wrapper").appendChild(this.dragObj.targetClone):a.classList.contains("e-card-wrapper")&&!t.closest(a,".e-swimlane-row")&&0===r.querySelectorAll(".e-card").length&&a.appendChild(this.dragObj.targetClone);else if(i.length>1){var c=r.offsetHeight,p=r.querySelector(".e-limits");p&&(c-=p.offsetHeight),this.dragObj.targetCloneMulti.style.height=t.formatUnit(c),[].slice.call(r.querySelectorAll(".e-card")).forEach(function(e){return t.addClass([e],"e-multi-clone-card")}),t.addClass([r],"e-multi-content-cell"),r.querySelector(".e-card-wrapper").style.height="auto",r.style.borderStyle="none",this.removeElement(this.dragObj.targetClone);for(var h=0,u=i;h<u.length;h++){var m=u[h],g=t.createElement("div",{className:"e-column-key",attrs:{"data-key":m.trim()}}),y=t.createElement("div",{className:"e-text",innerHTML:m.trim()});r.appendChild(this.dragObj.targetCloneMulti).appendChild(g).appendChild(y),g.style.lineHeight=g.style.height=t.formatUnit(c/i.length),y.style.top=t.formatUnit(c/2-y.offsetHeight/2)}}this.parent.notify(l,{})}this.addDropping();var f=!1;r&&(f=r.classList.contains("e-collapsed")&&r.classList.contains("e-dropping")),f&&(this.toggleVisible(a,void 0),t.addClass([r],"e-toggle-visible"));var v=[].slice.call(this.parent.element.querySelectorAll(".e-toggle-visible"));v.length>0&&!a.classList.contains("e-toggle-visible")&&!t.closest(a,".e-toggle-visible")&&(this.toggleVisible(a,v.slice(-1)[0]),t.removeClass(v,"e-toggle-visible")),this.parent.notify(l,{});var w=t.closest(a,".e-content-cells:not(.e-collapsed)");w&&(this.dragObj.targetClone.style.width=t.formatUnit(w.offsetWidth-2-16));var C=t.closest(a,".e-column-key");if(C){var b=[].slice.call(this.parent.element.querySelectorAll(".e-column-key")).filter(function(e){return n.getColumnKey(e)===n.getColumnKey(C)});b.length>0&&(t.addClass(b,"e-multi-active"),b[0].previousElementSibling&&t.addClass([b[0].previousElementSibling],"e-multi-bottom-border"))}if(document.body.style.cursor=r?"":"not-allowed",this.parent.swimlaneSettings.keyField&&!this.parent.swimlaneSettings.allowDragAndDrop){var S=t.closest(this.dragObj.element,".e-content-row"),E=t.closest(a,".e-content-row:not(.e-swimlane-row)");S&&E&&S.rowIndex!==E.rowIndex&&(document.body.style.cursor="not-allowed")}"not-allowed"===document.body.style.cursor&&(this.removeElement(this.dragObj.targetClone),this.multiCloneRemove()),this.updateScrollPosition(e);var k={data:this.dragObj.cardDetails,event:e,element:this.dragObj.selectedCards};this.parent.trigger("drag",k)}},e.prototype.removeElement=function(e){this.parent.element.getElementsByClassName(e.className).length>0&&t.remove(e)},e.prototype.addDropping=function(){if(this.parent.swimlaneSettings.keyField&&this.parent.swimlaneSettings.allowDragAndDrop){[].slice.call(this.parent.element.querySelectorAll(".e-content-row:not(.e-swimlane-row):not(.e-collapsed)")).forEach(function(e){return t.addClass(e.childNodes,"e-dropping")})}else{var e=t.closest(this.dragObj.draggedClone,".e-content-row");e&&[].slice.call(e.childNodes).forEach(function(e){return t.addClass([e],"e-dropping")})}var n=t.closest(this.dragObj.draggedClone,".e-content-cells");n&&t.removeClass([n],"e-dropping")},e.prototype.dragStop=function(e){var n,a=this,r=t.closest(this.dragObj.targetClone,".e-content-cells");this.parent.element.querySelector(".e-target-multi-clone")&&(n=t.closest(e.target,".e-column-key"));var l={cancel:!1,data:this.dragObj.cardDetails,event:e,element:this.dragObj.selectedCards};this.parent.trigger("dragStop",l,function(e){if(a.removeElement(a.dragObj.draggedClone),a.removeElement(a.dragObj.targetClone),a.removeElement(a.dragObj.cloneElement),[].slice.call(a.parent.element.querySelectorAll(".e-target-dragged-clone")).forEach(function(e){return t.remove(e)}),t.removeClass([a.dragObj.element],"e-kanban-dragged-card"),clearInterval(a.dragObj.navigationInterval),a.dragObj.navigationInterval=null,!e.cancel&&(r||n)){var l;r?l=a.getColumnKey(r):(l=a.getColumnKey(n),r=t.closest(n,".e-content-cells")),a.dragObj.selectedCards instanceof HTMLElement?a.updateDroppedData(a.dragObj.selectedCards,l,r):a.dragObj.selectedCards.forEach(function(e){a.updateDroppedData(e,l,r)})}"not-allowed"===document.body.style.cursor&&(document.body.style.cursor="");[].slice.call(a.parent.element.querySelectorAll(".e-content-row:not(.e-swimlane-row)")).forEach(function(e){return t.removeClass(e.childNodes,"e-dropping")}),a.parent.isAdaptive&&(a.parent.touchModule.tabHold=!1),a.dragObj.cardDetails=[]})},e.prototype.updateDroppedData=function(e,n,a){var r=this.parent.getCardDetails(e);if(1===n.split(",").length&&(r[this.parent.keyField]=n),this.parent.swimlaneSettings.keyField&&this.parent.swimlaneSettings.allowDragAndDrop){var l=t.closest(a,".e-content-row").previousElementSibling;if(this.parent.isAdaptive){var o=this.parent.layoutModule.kanbanRows[this.parent.layoutModule.swimlaneIndex].keyField;r[this.parent.swimlaneSettings.keyField]=o}else r[this.parent.swimlaneSettings.keyField]=this.getColumnKey(l)}this.parent.crudModule.updateCard(r)},e.prototype.toggleVisible=function(e,n){var a=this;[].slice.call(this.parent.element.querySelectorAll(".e-header-cells")).forEach(function(t){a.getColumnKey(t)===a.getColumnKey(n||e)&&a.parent.actionModule.columnToggle(t)});var r=t.closest(this.dragObj.draggedClone,".e-content-cells");if(r){var l=t.formatUnit(r.offsetWidth-16);this.dragObj.draggedClone.style.width=l,this.dragObj.cloneElement.style.width=l}},e.prototype.multiCloneRemove=function(){var e=[].slice.call(this.parent.element.querySelectorAll(".e-target-multi-clone"));e.length>0&&([].slice.call(this.parent.element.querySelectorAll(".e-column-key")).forEach(function(e){return t.remove(e)}),e.forEach(function(e){var n=t.closest(e,".e-content-cells");n&&(n.style.borderStyle=""),[].slice.call(n.querySelectorAll(".e-card")).forEach(function(e){return t.removeClass([e],"e-multi-clone-card")})}),this.removeElement(this.dragObj.targetCloneMulti))},e.prototype.calculateArgs=function(e){var t=this.getPageCoordinates(e);this.dragObj.pageY=t.pageY,this.dragObj.pageX=t.pageX},e.prototype.getPageCoordinates=function(e){var t=e.event;return t&&t.changedTouches?t.changedTouches[0]:e.changedTouches?e.changedTouches[0]:t||e},e.prototype.getColumnKey=function(e){return e?e.getAttribute("data-key").trim():""},e.prototype.updateScrollPosition=function(e){var n=this;t.isNullOrUndefined(this.dragObj.navigationInterval)&&(this.dragObj.navigationInterval=window.setInterval(function(){n.autoScrollValidation(e)&&n.autoScroll()},100))},e.prototype.autoScrollValidation=function(e){var t=this.dragObj.pageY,n=this.dragObj.pageX,a={left:!1,right:!1,top:!1,bottom:!1};return this.dragObj.pageY-window.scrollY<66&&(a.top=!0),t>window.innerHeight-30+window.pageYOffset&&t<window.innerHeight+window.pageYOffset&&(a.bottom=!0),n<30+window.pageXOffset&&n>0+window.pageXOffset&&(a.left=!0),n>window.innerWidth-30+window.pageXOffset&&n<window.innerWidth+window.pageXOffset&&(a.right=!0),this.dragEdges=a,a.bottom||a.top||a.left||a.right},e.prototype.autoScroll=function(){if(this.parent.isAdaptive){var e;if(this.dragEdges.top||this.dragEdges.bottom?e=this.dragObj.targetClone?t.closest(this.dragObj.targetClone,".e-card-wrapper"):t.closest(this.dragObj.draggedClone,".e-card-wrapper"):(this.dragEdges.right||this.dragEdges.left)&&(e=this.parent.element.querySelector("."+C)),e){var n=e.offsetHeight<=e.scrollHeight,a=e.offsetWidth<=e.scrollWidth,r=e.scrollTop>=0&&e.scrollTop+e.offsetHeight<=e.scrollHeight,l=e.scrollLeft>=0&&e.scrollLeft+e.offsetWidth<=e.scrollWidth;if(n&&r&&(this.dragEdges.top||this.dragEdges.bottom)&&(e.scrollTop+=this.dragEdges.top?-66:30),a&&l&&(this.dragEdges.left||this.dragEdges.right)){(this.parent.layoutModule.getWidth()*(this.parent.columns.length-1)>e.scrollLeft||this.dragEdges.left)&&(e.scrollLeft+=this.dragEdges.left?-30:30)}}}else this.dragObj.pageY-window.scrollY<30?window.scrollTo(window.scrollX,window.scrollY-30):window.innerHeight-(this.dragObj.pageY-window.scrollY)<30&&window.scrollTo(window.scrollX,window.scrollY+30)},e.prototype.unWireDragEvents=function(e){var t=e.ej2_instances[0];t&&!t.isDestroyed&&t.destroy()},e}(),k=function(){function e(e){this.keyConfigs={firstCardSelection:"36",lastCardSelection:"35",upArrow:"38",downArrow:"40",rightArrow:"39",leftArrow:"37",swimlaneExpandAll:"ctrl+40",swimlaneCollapseAll:"ctrl+38",selectedSwimlaneExpand:"alt+40",selectedSwimlaneCollapse:"alt+38",selectedColumnCollapse:"ctrl+37",selectedColumnExpand:"ctrl+39",multiSelectionByUpArrow:"shift+38",multiSelectionByDownArrow:"shift+40",multiSelectionByLeftArrow:"shift+37",multiSelectionByRightArrow:"shift+39"},this.parent=e,this.parent.element.tabIndex=-1===this.parent.element.tabIndex?0:this.parent.element.tabIndex,this.keyboardModule=new t.KeyboardEvents(this.parent.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})}return e.prototype.keyActionHandler=function(e){var n=this.parent.element.querySelectorAll(".e-card.e-selection").item(0);if(n||"firstCardSelection"===e.action||"lastCardSelection"===e.action){var a;switch(e.action){case"upArrow":case"downArrow":case"multiSelectionByUpArrow":case"multiSelectionByDownArrow":var r=".e-content-cells[data-key="+(a=t.closest(this.parent.actionModule.lastCardSelection,".e-content-cells").getAttribute("data-key"))+"] .e-card",l=[].slice.call(this.parent.element.querySelectorAll(r)),o=this.parent.actionModule.lastCardSelection.getAttribute("data-id"),i=this.getCardId(l).indexOf(o),s=("multiSelectionByUpArrow"===e.action||"multiSelectionByDownArrow"===e.action)&&"Multiple"===this.parent.cardSettings.selectionType,d="upArrow"===e.action||"multiSelectionByUpArrow"===e.action?i-1:i+1;this.parent.actionModule.cardSelection(l[d],!1,s);break;case"rightArrow":case"leftArrow":case"multiSelectionByLeftArrow":case"multiSelectionByRightArrow":this.moveCards(e.action,this.parent.actionModule.lastCardSelection);break;case"firstCardSelection":case"lastCardSelection":if(n){t.removeClass([n],"e-selection");var c=this.parent.actionModule.selectionArray;c.splice(c.indexOf(n.getAttribute("data-id")),1)}var p=[].slice.call(this.parent.element.querySelectorAll(".e-card")),h="firstCardSelection"===e.action?p[0]:p[p.length-1];this.parent.actionModule.cardSelection(h,!1,!1);break;case"swimlaneExpandAll":case"swimlaneCollapseAll":case"selectedSwimlaneExpand":case"selectedSwimlaneCollapse":this.parent.swimlaneSettings.keyField&&this.swimlaneExpandCollapse(e.action);break;case"selectedColumnExpand":case"selectedColumnCollapse":a=n.getAttribute("data-key");var u=this.parent.element.querySelector(".e-header-cells[data-key="+a+"]");if(u.classList.contains("e-toggle-header")){if(u.classList.contains("e-collapsed")&&"selectedColumnCollapse"===e.action||!u.classList.contains("e-collapsed")&&"selectedColumnExpand"===e.action)return;this.parent.actionModule.columnExpandCollapse(u)}}}},e.prototype.swimlaneExpandCollapse=function(e){var n=".e-card.e-selection";"swimlaneExpandAll"!==e&&"swimlaneCollapseAll"!==e||(n=".e-content-row.e-swimlane-row");var a=[].slice.call(this.parent.element.querySelectorAll(n)),r=this.parent.element.querySelectorAll(n+".e-collapsed").length;"swimlaneCollapseAll"===e&&a.length-r==0||"swimlaneExpandAll"===e&&a.length-r===a.length||a.forEach(function(e){e.classList.contains("e-card")&&(e=t.closest(e,".e-content-row").previousElementSibling),e.classList.contains("e-collapsed")?(t.removeClass([e,e.nextElementSibling],"e-collapsed"),t.classList(e.querySelector(".e-icons"),["e-swimlane-row-expand"],["e-swimlane-row-collapse"])):e.classList.contains("e-collapsed")||(t.addClass([e,e.nextElementSibling],"e-collapsed"),t.classList(e.querySelector(".e-icons"),["e-swimlane-row-collapse"],["e-swimlane-row-expand"]))})},e.prototype.getCardId=function(e){var t=[];return e.forEach(function(e){return t.push(e.getAttribute("data-id"))}),t},e.prototype.moveNextRow=function(e){for(var t=0;t<e.childElementCount;t++){var n=e.children[t],a=[].slice.call(n.querySelectorAll(".e-card"));if(a.length>0){this.parent.actionModule.cardSelection(a[0],!1,!1),e.classList.contains("e-collapsed")&&this.swimlaneExpandCollapse("selectedSwimlaneExpand");break}}},e.prototype.movePreviousRow=function(e){for(var t=e.childElementCount-1;t>=0;t--){var n=e.children[t],a=[].slice.call(n.querySelectorAll(".e-card"));if(a.length>0){e.classList.contains("e-collapsed")||this.swimlaneExpandCollapse("selectedSwimlaneCollapse"),this.parent.actionModule.cardSelection(a.slice(-1)[0],!1,!1);break}}},e.prototype.cardIndex=function(e,t,n,a){if(e){var r=("multiSelectionByRightArrow"===a||"multiSelectionByLeftArrow"===a)&&"Multiple"===this.parent.cardSettings.selectionType;t[n]?this.parent.actionModule.cardSelection(t[n],!1,r):this.parent.actionModule.cardSelection(t.slice(-1)[0],!1,r)}},e.prototype.moveCards=function(e,n){var a,r,l=t.closest(n,".e-content-cells"),o=[].slice.call(l.querySelectorAll(".e-card")),i=t.closest(l,".e-content-row"),s=this.getCardId(o).indexOf(n.getAttribute("data-id"));if("rightArrow"===e||"multiSelectionByRightArrow"===e)if(l.cellIndex===i.childElementCount-1&&this.parent.swimlaneSettings.keyField&&"multiSelectionByRightArrow"!==e){if(s<this.getCardId(o).length-1)this.parent.actionModule.cardSelection(this.parent.actionModule.lastCardSelection.nextElementSibling,!1,!1);else if(i.rowIndex!==this.parent.element.querySelectorAll(".e-content-row").length-1){var d=this.parent.element.querySelector(".e-content-row:nth-child("+(i.rowIndex+3)+")");this.moveNextRow(d)}}else{for(var c=!1,p=l.cellIndex+1;p<i.children.length;p++)if(a=i.children[p],(r=[].slice.call(a.querySelectorAll(".e-card"))).length>0){c=!0;break}this.cardIndex(c,r,s,e)}else if(0===l.cellIndex&&this.parent.swimlaneSettings.keyField&&"multiSelectionByLeftArrow"!==e){if(s>0)this.parent.actionModule.cardSelection(this.parent.actionModule.lastCardSelection.previousElementSibling,!1,!1);else if(i.rowIndex>1){var h=".e-content-row:nth-child("+(i.rowIndex-1)+"):not(.e-collapsed)";(d=this.parent.element.querySelector(h))&&this.movePreviousRow(d)}}else{for(var c=!1,p=l.cellIndex-1;p>=0;p--){if(a=i.children[p],(r=[].slice.call(a.querySelectorAll(".e-card"))).length>0){c=!0;break}if(0===p&&this.parent.swimlaneSettings.keyField){var u=this.parent.element.querySelector(".e-content-row:nth-child("+(i.rowIndex-1)+")");this.movePreviousRow(u)}}this.cardIndex(c,r,s,e)}},e.prototype.getModuleName=function(){return"keyboard"},e.prototype.destroy=function(){this.keyboardModule.destroy()},e}(),O=function(){function e(e){this.parent=e,this.renderTooltip()}return e.prototype.renderTooltip=function(){this.tooltipObj=new n.Tooltip({cssClass:this.parent.cssClass+" e-kanban-tooltip",enableRtl:this.parent.enableRtl,mouseTrail:!this.parent.isAdaptive,offsetY:5,position:"BottomCenter",showTipPointer:!0,target:".e-tooltip-text",beforeRender:this.onBeforeRender.bind(this)}),this.tooltipObj.appendTo(this.parent.element),this.tooltipObj.isStringTemplate=!0},e.prototype.onBeforeRender=function(e){var n;if(this.parent.tooltipTemplate){n=t.createElement("div");var a=t.closest(e.target,".e-card"),r=this.parent.getCardDetails(a),l=this.parent.templateParser(this.parent.tooltipTemplate)(r);t.append(l,n)}else n='<div class="e-card-header-caption">'+e.target.innerText+"</div>";this.tooltipObj.setProperties({content:n},!0)},e.prototype.destroy=function(){this.tooltipObj.destroy(),t.addClass([this.parent.element],"e-control"),this.tooltipObj=null},e}(),A=function(){function e(e){this.parent=e,this.tabHold=!1}return e.prototype.wireTouchEvents=function(){this.element=this.parent.element.querySelector("."+C),this.touchObj=new t.Touch(this.element,{tapHold:this.tapHoldHandler.bind(this)})},e.prototype.tapHoldHandler=function(e){this.tabHold=!0},e.prototype.destroy=function(){this.touchObj.destroy(),this.tabHold=!1,this.element=null},e}(),M=function(){function e(e){this.parent=e}return e.prototype.renderSwimlaneHeader=function(){var e=t.createElement("div",{className:"e-swimlane-header"});e.innerHTML='<div class="e-swimlane-header-toolbar"><div class="e-toolbar-menu"><div class="e-icons e-icon-menu"></div></div><div class="e-toolbar-level-title"><div class="e-toolbar-swimlane-name"></div></div></div>',this.parent.element.appendChild(e),t.EventHandler.add(e.querySelector(".e-icon-menu"),"click",this.menuClick,this)},e.prototype.renderSwimlaneTree=function(){var e=this.parent.element.querySelector(".e-swimlane-header").offsetHeight,a=window.innerHeight-e;this.popupOverlay=t.createElement("div",{className:"e-swimlane-overlay",styles:"height: "+a+"px;"});var l=t.createElement("div",{className:"e-swimlane-content",styles:"top:"+e+"px;"}),o=t.createElement("div",{className:"e-swimlane-resource e-popup-close",styles:"height: "+a+"px;"});l.appendChild(o),l.appendChild(this.popupOverlay),this.parent.element.appendChild(l);var i=t.createElement("div",{className:"e-swimlane-tree"});o.appendChild(i),this.treeViewObj=new r.TreeView({cssClass:this.parent.cssClass,enableRtl:this.parent.enableRtl,fields:{dataSource:this.parent.layoutModule.kanbanRows,id:"keyField",text:"textField"},nodeTemplate:this.parent.swimlaneSettings.template,nodeClicked:this.treeSwimlaneClick.bind(this)}),this.treeViewObj.appendTo(i),this.treePopup=new n.Popup(o,{targetType:"relative",actionOnScroll:"none",content:this.treeViewObj.element,enableRtl:this.parent.enableRtl,zIndex:10,hideAnimation:{name:"SlideLeftOut",duration:500},showAnimation:{name:"SlideLeftIn",duration:500},viewPortElement:this.parent.element.querySelector("."+C)})},e.prototype.menuClick=function(e){if(this.parent.element.querySelector(".e-swimlane-resource").classList.contains("e-popup-open"))this.treePopup.hide(),t.removeClass([this.popupOverlay],"e-enable");else{var n=[].slice.call(this.treeViewObj.element.querySelectorAll(".e-list-item"));t.removeClass(n,"e-active"),t.addClass([n[this.parent.layoutModule.swimlaneIndex]],"e-active"),this.treePopup.show(),t.addClass([this.popupOverlay],"e-enable")}},e.prototype.treeSwimlaneClick=function(e){this.treePopup.hide();var t=[].slice.call(this.treeViewObj.element.querySelectorAll(".e-list-item"));this.parent.layoutModule.swimlaneIndex=t.indexOf(e.node),this.parent.layoutModule.scrollLeft=0,this.parent.notify(o,{processedData:this.parent.kanbanData}),e.event.preventDefault()},e.prototype.getWidth=function(){return 80*window.innerWidth/100},e}(),x=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),j=function(e){function n(t){var n=e.call(this,t)||this;return n.kanbanRows=[],n.parent=t,n.columnKeys=[],n.swimlaneIndex=0,n.scrollLeft=0,n.wireEvents(),n}return x(n,e),n.prototype.initRender=function(){if(0!==this.parent.columns.length){if(this.columnData=this.getColumnCards(),this.kanbanRows=this.getRows(),this.parent.isAdaptive){var e=this.parent.element.querySelector("."+C);e&&(this.scrollLeft=e.scrollLeft)}this.destroy(),this.wireEvents(),this.parent.isAdaptive&&this.parent.swimlaneSettings.keyField&&this.renderSwimlaneHeader();var n=t.createElement("div",{className:"e-kanban-header"});this.parent.element.appendChild(n),this.renderHeader(n),this.renderContent(),this.renderCards(),this.renderValidation(),this.parent.isAdaptive&&(this.parent.touchModule.wireTouchEvents(),this.parent.element.querySelector("."+C).scrollLeft=this.scrollLeft),this.parent.notify(l,{})}},n.prototype.renderHeader=function(e){var n=this,a=t.createElement("div",{className:this.parent.swimlaneSettings.keyField?"e-swimlane":""});e.appendChild(a);var r=t.createElement("table",{className:"e-kanban-table e-header-table"});a.appendChild(r),this.renderColGroup(r);var l=t.createElement("thead");r.appendChild(l),this.parent.stackedHeaders.length>0&&l.appendChild(this.createStackedRow(this.parent.stackedHeaders));var o=t.createElement("tr",{className:"e-header-row"});l.appendChild(o);for(var i=this,s=0,d=this.parent.columns;s<d.length;s++)!function(e){if(i.isColumnVisible(e)){var a=i.parent.actionModule.columnToggleArray.indexOf(e.keyField),r=t.createElement("th",{className:-1===a?"e-header-cells":"e-header-cells e-collapsed",attrs:{"data-role":"kanban-column","data-key":e.keyField}}),l=[];e.allowToggle&&(l.push("e-toggle-header"),e.isExpanded||l.push("e-collapsed")),t.addClass([r],l);var s=t.createElement("div",{className:"e-header-wrap"});if(r.appendChild(s),e.template){t.addClass([r],"e-template");var d=i.parent.templateParser(e.template)(e);t.append(d,s)}else{var c=t.createElement("div",{className:"e-header-text",innerHTML:e.headerText});if(s.appendChild(c),e.showItemCount){var p=i.columnData[e.keyField].length;c.appendChild(t.createElement("div",{className:"e-total-card",innerHTML:"- "+p.toString()+" "+i.parent.localeObj.getConstant("items")}))}}var h={data:[{keyField:e.keyField,textField:e.headerText}],element:o,cancel:!1,requestType:"headerRow"};i.parent.trigger("columnRendered",h,function(l){if(!l.cancel&&(o.appendChild(r),e.allowToggle)){var i=e.isExpanded&&-1===a?"e-column-expand":"e-column-collapse",s=t.createElement("div",{className:"e-header-icon e-icons "+i});r.appendChild(s),n.wireEvents(s,"columnExpandCollapse")}})}}(d[s])},n.prototype.renderContent=function(){var e=t.createElement("div",{className:C});this.parent.element.appendChild(e);var n=t.createElement("div",{className:this.parent.swimlaneSettings.keyField?"e-swimlane":""});e.appendChild(n);var a=t.createElement("table",{className:"e-kanban-table e-content-table"});n.appendChild(a),this.renderColGroup(a);var r=t.createElement("tbody");a.appendChild(r);var l,o=!1;this.swimlaneRow=this.kanbanRows,this.parent.swimlaneSettings.keyField&&this.parent.isAdaptive&&(this.swimlaneRow=[this.kanbanRows[this.swimlaneIndex]],this.renderSwimlaneTree(),this.parent.element.querySelector(".e-toolbar-swimlane-name").innerHTML=this.kanbanRows[this.swimlaneIndex].textField);for(var i=this,s=0,d=this.swimlaneRow;s<d.length;s++)!function(e){if(i.parent.swimlaneSettings.keyField&&0!==i.parent.actionModule.swimlaneToggleArray.length){var n=i.parent.actionModule.swimlaneToggleArray.indexOf(e.keyField);o=-1!==n}l=o?"e-content-row e-collapsed":"e-content-row";var a=t.createElement("tr",{className:l});i.parent.swimlaneSettings.keyField&&!i.parent.isAdaptive&&i.renderSwimlaneRow(r,e,o);for(var s=0,d=i.parent.columns;s<d.length;s++){var c=d[s];if(i.isColumnVisible(c)){var p=-1===(n=i.parent.actionModule.columnToggleArray.indexOf(c.keyField))?"e-content-cells":"e-content-cells e-collapsed",h=t.createElement("td",{className:p,attrs:{"data-role":"kanban-column","data-key":c.keyField}});(c.allowToggle&&!c.isExpanded||-1!==n)&&(t.addClass([h],"e-collapsed"),h.appendChild(t.createElement("div",{className:"e-collapse-header-text",innerHTML:c.headerText}))),a.appendChild(h);var u={data:[{keyField:e.keyField,textField:e.textField}],element:a,cancel:!1,requestType:"contentRow"};i.parent.trigger("columnRendered",u,function(e){e.cancel||r.appendChild(a)})}}}(d[s]);this.wireEvents(e,"scroll")},n.prototype.renderSwimlaneRow=function(e,n,a){var r=this,l=a?" e-collapsed":"",o=t.createElement("tr",{className:"e-content-row e-swimlane-row"+l,attrs:{"data-key":n.keyField}}),i=this.parent.columns.length-this.parent.actionModule.hideColumnKeys.length,s=t.createElement("td",{className:"e-content-cells",attrs:{"data-role":"kanban-column",colspan:i.toString()}}),d=a?"e-swimlane-row-collapse":"e-swimlane-row-expand",c=t.createElement("div",{className:"e-icons "+d});if(s.appendChild(c),this.parent.swimlaneSettings.template){t.addClass([s],"e-template");var p=this.parent.templateParser(this.parent.swimlaneSettings.template)(n);t.append(p,s)}else s.appendChild(t.createElement("div",{className:"e-swimlane-text",innerHTML:n.textField,attrs:{"data-role":n.textField}})),this.parent.swimlaneSettings.showItemCount&&s.appendChild(t.createElement("div",{className:"e-swimlane-item-count"}));o.appendChild(s);var h={data:[{keyField:n.keyField,textField:n.textField}],element:o,cancel:!1,requestType:"swimlaneRow"};this.parent.trigger("columnRendered",h,function(t){t.cancel||(e.appendChild(o),r.wireEvents(o,"rowExpandCollapse"))})},n.prototype.renderCards=function(){var e=this,n=this.swimlaneRow,a=[].slice.call(this.parent.element.querySelectorAll(".e-content-row:not(.e-swimlane-row)")),r=[].slice.call(this.parent.element.querySelectorAll(".e-content-row.e-swimlane-row")),l=[];a.forEach(function(a,o){for(var i=0,s=0,d=e.parent.columns;s<d.length;s++)!function(r){if(e.isColumnVisible(r)){var l=e.columnData[r.keyField];e.parent.swimlaneSettings.keyField&&(l=l.filter(function(t){return t[e.parent.swimlaneSettings.keyField]===n[o].keyField})),i+=l.length;var s=a.querySelector('[data-key="'+r.keyField+'"]'),d=t.createElement("div",{className:"e-card-wrapper"});s.appendChild(d);for(var c=0,p=l;c<p.length;c++)!function(n){var a=n[e.parent.cardSettings.headerField],r=-1===e.parent.actionModule.selectionArray.indexOf(a)?"":" e-selection",l=t.createElement("div",{className:"e-card"+r,attrs:{"data-id":n[e.parent.cardSettings.headerField],"data-key":n[e.parent.keyField]}});if(e.parent.cardSettings.template){t.addClass([l],"e-template");var o=e.parent.templateParser(e.parent.cardSettings.template)(n);t.append(o,l)}else{var i=e.parent.enableTooltip?" e-tooltip-text":"";if(e.parent.cardSettings.showHeader){var s=t.createElement("div",{className:"e-card-header"}),c=t.createElement("div",{className:"e-card-header-caption"+i,innerHTML:n[e.parent.cardSettings.headerField]||""});s.appendChild(c),l.appendChild(s)}var p=t.createElement("div",{className:"e-card-content"}),h=t.createElement("div",{className:"e-card-content-caption"+i,innerHTML:n[e.parent.cardSettings.contentField]||""});p.appendChild(h),l.appendChild(p)}var u={data:n,element:l,cancel:!1};e.parent.trigger("cardRendered",u,function(t){t.cancel||(d.appendChild(l),e.wireEvents(l,"card"),e.parent.allowDragAndDrop&&e.parent.dragAndDropModule.wireDragEvents(l))})}(p[c])}}(d[s]);if(r.length>0&&e.parent.swimlaneSettings.showItemCount&&!e.parent.swimlaneSettings.template){var c=e.parent.localeObj.getConstant("items");r[o].querySelector(".e-swimlane-item-count").innerHTML="- "+i.toString()+" "+c}0===i&&(l.push(a),r.length>0&&l.push(r[o]))}),this.parent.swimlaneSettings.showEmptyRow||l.forEach(function(e){return t.remove(e)})},n.prototype.renderColGroup=function(e){var n=this,a=t.createElement("colgroup");this.parent.columns.forEach(function(e){if(n.isColumnVisible(e)){var r=n.parent.actionModule.columnToggleArray.indexOf(e.keyField),l=e.allowToggle&&!e.isExpanded,o=-1===r?l?"e-collapsed":"":"e-collapsed",i=t.createElement("col",{className:o,attrs:{"data-key":e.keyField},styles:n.parent.isAdaptive?"width: "+(l?t.formatUnit(50):t.formatUnit(n.getWidth())):""});a.appendChild(i)}}),e.appendChild(a)},n.prototype.getRows=function(){var e=this,t=[];return this.parent.swimlaneSettings.keyField?(this.parent.kanbanData.map(function(n){!e.parent.swimlaneSettings.showEmptyRow&&e.parent.isAdaptive&&-1===e.columnKeys.indexOf(n[e.parent.keyField])||t.push({keyField:n[e.parent.swimlaneSettings.keyField],textField:n[e.parent.swimlaneSettings.textField]||n[e.parent.swimlaneSettings.keyField]})}),(t=t.filter(function(e,t,n){return t===n.map(function(e){return e.keyField}).indexOf(e.keyField)})).sort(function(e,t){return e.textField>t.textField?1:t.textField>e.textField?-1:0}),"Descending"===this.parent.swimlaneSettings.sortBy&&t.reverse()):t.push({keyField:"",textField:""}),t},n.prototype.createStackedRow=function(e){var n=t.createElement("tr",{className:"e-header-row e-stacked-header-row"}),a=[];this.parent.columns.forEach(function(t){for(var n="",r=0,l=e;r<l.length;r++){var o=l[r];-1!==o.keyFields.indexOf(t.keyField)&&(n=o.text)}a.push(n)});for(var r=0;r<a.length;r++){for(var l=1,o=r+1;o<a.length&&(""!==a[r]&&""!==a[o]&&a[r]===a[o]);o++)l++;var i=t.createElement("div",{className:"e-header-text",innerHTML:a[r]}),s=t.createElement("th",{className:"e-header-cells e-stacked-header-cell",attrs:{colspan:l.toString()}});n.appendChild(s).appendChild(i),r+=l-1}return n},n.prototype.scrollUiUpdate=function(){var e=this,n=this.parent.element.querySelector(".e-kanban-header"),a=this.parent.element.querySelector("."+C),r=this.parent.element.offsetHeight-n.offsetHeight;if(this.parent.isAdaptive){r=window.innerHeight-(n.offsetHeight+25);var l=this.parent.element.querySelector(".e-swimlane-header");l&&(r-=l.offsetHeight),[].slice.call(this.parent.element.querySelectorAll(".e-content-cells")).forEach(function(n){n.classList.contains("e-multi-content-cell")||(n.querySelector(".e-card-wrapper").style.height=t.formatUnit(r),t.EventHandler.add(n,"touchmove",e.onAdaptiveScroll,e))})}"auto"!==this.parent.height&&"100%"!==this.parent.height&&(a.style.height=t.formatUnit(r)),[].slice.call(n.childNodes).forEach(function(n){var r=0;a.offsetWidth-a.clientWidth>0&&(r=17,a.offsetHeight-a.clientHeight>0&&(n.style.width=t.formatUnit(a.clientWidth))),e.parent.enableRtl?n.style.paddingLeft=t.formatUnit(r):n.style.paddingRight=t.formatUnit(r)})},n.prototype.onContentScroll=function(e){this.parent.element.querySelector(".e-kanban-header div").scrollLeft=e.target.scrollLeft},n.prototype.onAdaptiveScroll=function(e){this.parent.touchModule.tabHold&&e.preventDefault()},n.prototype.isColumnVisible=function(e){var t=this,n=!1;return e.keyField.split(",").forEach(function(e){n=-1===t.parent.actionModule.hideColumnKeys.indexOf(e)}),n},n.prototype.renderLimits=function(e,n){var a=t.createElement("div",{className:"e-limits"});e.minCount&&a.appendChild(t.createElement("div",{className:"e-min-count",innerHTML:this.parent.localeObj.getConstant("min")+": "+e.minCount.toString()})),e.maxCount&&a.appendChild(t.createElement("div",{className:"e-max-count",innerHTML:this.parent.localeObj.getConstant("max")+": "+e.maxCount.toString()})),a.childElementCount>0&&(n.firstElementChild.classList.contains("e-card-wrapper")?n.insertBefore(a,n.firstElementChild):n.appendChild(a))},n.prototype.renderValidation=function(){var e=this,n=function(e,t){var n;return e.maxCount&&t>e.maxCount?n="e-max-color":e.minCount&&t<e.minCount&&(n="e-min-color"),n};this.parent.columns.forEach(function(a){if(a.minCount||a.maxCount){var r=e.columnData[a.keyField],l='[data-key="'+a.keyField+'"]',o=e.parent.element.querySelector(".e-header-cells"+l),i=[].slice.call(e.parent.element.querySelectorAll(".e-content-cells"+l));if("Swimlane"===e.parent.constraintType&&e.parent.swimlaneSettings.keyField)e.kanbanRows.forEach(function(l,o){e.renderLimits(a,i[o]);var s=r.filter(function(t){return t[e.parent.swimlaneSettings.keyField]===l.keyField}),d=n(a,s.length);d&&t.addClass([i[o]],d)});else{e.renderLimits(a,o);var s=n(a,r.length);s&&t.addClass(i.concat(o),s)}}})},n.prototype.getColumnCards=function(){var e=this,t={};return this.columnKeys=[],this.parent.columns.forEach(function(n){for(var a=[],r=0,l=n.keyField.split(",");r<l.length;r++)!function(t){e.columnKeys.push(t.trim());var n=e.parent.kanbanData.filter(function(n){return n[e.parent.keyField]===t.trim()});a=a.concat(n)}(l[r]);t[n.keyField]=a}),t},n.prototype.wireEvents=function(e,n){switch(n){case"card":t.EventHandler.add(e,"click",this.parent.actionModule.cardClick,this.parent.actionModule),t.EventHandler.add(e,"dblclick",this.parent.actionModule.cardDoubleClick,this.parent.actionModule);break;case"rowExpandCollapse":t.EventHandler.add(e,"click",this.parent.actionModule.rowExpandCollapse,this.parent.actionModule);break;case"columnExpandCollapse":t.EventHandler.add(e,"click",this.parent.actionModule.columnExpandCollapse,this.parent.actionModule);break;case"scroll":t.EventHandler.add(e,"scroll",this.onContentScroll,this);break;default:this.parent.on(o,this.initRender,this),this.parent.on(l,this.scrollUiUpdate,this)}},n.prototype.unWireEvents=function(e,n){switch(n){case"card":t.EventHandler.remove(e,"click",this.parent.actionModule.cardClick),t.EventHandler.remove(e,"dblclick",this.parent.actionModule.cardDoubleClick);break;case"rowExpandCollapse":t.EventHandler.remove(e,"click",this.parent.actionModule.rowExpandCollapse);break;case"columnExpandCollapse":t.EventHandler.remove(e,"click",this.parent.actionModule.columnExpandCollapse);break;case"scroll":t.EventHandler.remove(e,"scroll",this.onContentScroll);break;default:this.parent.off(o,this.initRender),this.parent.off(l,this.scrollUiUpdate)}},n.prototype.refreshHeaders=function(){var e=this.parent.element.querySelector(".e-kanban-header");[].slice.call(e.children).forEach(function(e){return t.remove(e)}),this.renderHeader(e)},n.prototype.refreshCards=function(){[].slice.call(this.parent.element.querySelectorAll(".e-card-wrapper")).forEach(function(e){return t.remove(e)}),this.renderCards()},n.prototype.destroy=function(){var e=this;this.unWireEvents(),[].slice.call(this.parent.element.querySelectorAll(".e-card")).forEach(function(t){return e.unWireEvents(t,"card")}),[].slice.call(this.parent.element.querySelectorAll(".e-swimlane-row")).forEach(function(t){return e.unWireEvents(t,"rowExpandCollapse")}),[].slice.call(this.parent.element.querySelectorAll(".e-header-icon")).forEach(function(t){return e.unWireEvents(t,"columnExpandCollapse")});var n=this.parent.element.querySelector(".e-kanban-header");n&&t.remove(n);var a=this.parent.element.querySelector("."+C);a&&(this.unWireEvents(a,"scroll"),t.remove(a)),this.treeViewObj&&(this.treeViewObj.destroy(),this.treeViewObj=null),this.treePopup&&(this.treePopup.destroy(),this.treePopup=null);var r=this.parent.element.querySelector(".e-swimlane-header");r&&t.remove(r);var l=this.parent.element.querySelector(".e-swimlane-content");l&&t.remove(l)},n}(M),R=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),D=function(e,t,n,a){var r,l=arguments.length,o=l<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(o=(l<3?r(o):l>3?r(t,n,o):r(t,n))||o);return l>3&&o&&Object.defineProperty(t,n,o),o},T=function(e){function a(t,n){return e.call(this,t,n)||this}return R(a,e),a.prototype.preRender=function(){this.isAdaptive=t.Browser.isDevice,this.kanbanData=[],this.activeCardData={data:null,element:null};var e={items:"items",min:"Min",max:"Max"};this.localeObj=new t.L10n(this.getModuleName(),e,this.locale)},a.prototype.requiredModules=function(){return[]},a.prototype.getPersistData=function(){return this.addOnPersist([])},a.prototype.getModuleName=function(){return"kanban"},a.prototype.render=function(){var e=[],a=[];e.push("e-kanban"),this.enableRtl?e.push("e-rtl"):a.push("e-rtl"),this.isAdaptive?e.push("e-device"):a.push("e-device"),this.cssClass&&e.push(this.cssClass),t.classList(this.element,e,a),this.element.style.width=t.formatUnit(this.width),this.element.style.height=t.formatUnit(this.height),n.createSpinner({target:this.element}),this.showSpinner(),this.initializeModules()},a.prototype.onPropertyChanged=function(e,n){for(var a=this,r=0,s=Object.keys(e);r<s.length;r++)switch(s[r]){case"cssClass":n.cssClass&&t.removeClass([this.element],n.cssClass),e.cssClass&&t.addClass([this.element],e.cssClass);break;case"enableRtl":case"locale":this.refresh();break;case"width":this.element.style.width=t.formatUnit(e.width),this.element.querySelector(".e-kanban-header").firstElementChild.style.width="auto",this.notify(l,{});break;case"height":this.element.style.height=t.formatUnit(e.height),this.element.querySelector("."+C).style.height="auto",this.notify(l,{});break;case"dataSource":case"query":this.dataModule=new i(this);break;case"columns":case"constraintType":this.notify(o,{processedData:this.kanbanData});break;case"swimlaneSettings":this.onSwimlaneSettingsPropertyChanged(e.swimlaneSettings,n.swimlaneSettings);break;case"cardSettings":this.onCardSettingsPropertyChanged(e.cardSettings,n.cardSettings);break;case"allowDragAndDrop":[].slice.call(this.element.querySelectorAll(".e-card")).forEach(function(t){e.allowDragAndDrop?a.dragAndDropModule.wireDragEvents(t):a.dragAndDropModule.unWireDragEvents(t)});break;case"enableTooltip":this.tooltipModule&&(this.tooltipModule.destroy(),this.tooltipModule=null),e.enableTooltip&&(this.tooltipModule=new O(this),this.layoutModule.refreshCards());break;case"allowKeyboard":this.keyboardModule&&(this.keyboardModule.destroy(),this.keyboardModule=null),e.allowKeyboard&&(this.keyboardModule=new k(this));break;case"stackedHeaders":this.layoutModule.refreshHeaders()}},a.prototype.onSwimlaneSettingsPropertyChanged=function(e,t){for(var n=0,a=Object.keys(e);n<a.length;n++)switch(a[n]){case"keyField":case"textField":case"showEmptyRow":case"showItemCount":case"template":case"sortBy":this.notify(o,{processedData:this.kanbanData})}},a.prototype.onCardSettingsPropertyChanged=function(e,n){for(var a=0,r=Object.keys(e);a<r.length;a++)switch(r[a]){case"showHeader":case"headerField":case"contentField":case"template":this.layoutModule.refreshCards();break;case"selectionType":var l=this.getSelectedCards();l.length>0&&t.removeClass(l,"e-selection")}},a.prototype.initializeModules=function(){this.dataModule=new i(this),this.layoutModule=new j(this),this.allowKeyboard&&(this.keyboardModule=new k(this)),this.actionModule=new b(this),this.crudModule=new S(this),this.dragAndDropModule=new E(this),this.enableTooltip&&(this.tooltipModule=new O(this)),(t.Browser.isDevice||t.Browser.isTouch)&&(this.touchModule=new A(this))},a.prototype.destroyModules=function(){this.layoutModule&&(this.layoutModule.destroy(),this.layoutModule=null),this.keyboardModule&&(this.keyboardModule.destroy(),this.keyboardModule=null),this.touchModule&&(this.touchModule.destroy(),this.touchModule=null),this.actionModule=null,this.crudModule=null,this.dataModule=null,this.dragAndDropModule=null},a.prototype.templateParser=function(e){if(e)try{if(document.querySelectorAll(e).length)return t.compile(document.querySelector(e).innerHTML.trim())}catch(n){return t.compile(e)}},a.prototype.getCardDetails=function(e){var t=this,n="number"==typeof this.kanbanData[0][this.cardSettings.headerField]?parseInt(e.getAttribute("data-id"),10):e.getAttribute("data-id");return this.kanbanData.filter(function(e){return e[t.cardSettings.headerField]===n})[0]},a.prototype.getSelectedCards=function(){return[].slice.call(this.element.querySelectorAll(".e-card.e-selection"))},a.prototype.showSpinner=function(){n.showSpinner(this.element)},a.prototype.hideSpinner=function(){n.hideSpinner(this.element)},a.prototype.addCard=function(e){this.crudModule.addCard(e)},a.prototype.updateCard=function(e){this.crudModule.updateCard(e)},a.prototype.deleteCard=function(e){this.crudModule.deleteCard(e)},a.prototype.addColumn=function(e,t){this.actionModule.addColumn(e,t)},a.prototype.deleteColumn=function(e){this.actionModule.deleteColumn(e)},a.prototype.showColumn=function(e){this.actionModule.showColumn(e)},a.prototype.hideColumn=function(e){this.actionModule.hideColumn(e)},a.prototype.destroy=function(){this.destroyModules(),e.prototype.destroy.call(this),this.element.innerHTML="";var n=["e-kanban"];this.cssClass&&(n=n.concat(this.cssClass.split(" "))),t.removeClass([this.element],n)},D([t.Property()],a.prototype,"cssClass",void 0),D([t.Property("auto")],a.prototype,"width",void 0),D([t.Property("auto")],a.prototype,"height",void 0),D([t.Property([])],a.prototype,"dataSource",void 0),D([t.Property()],a.prototype,"query",void 0),D([t.Property()],a.prototype,"keyField",void 0),D([t.Property("Column")],a.prototype,"constraintType",void 0),D([t.Collection([],y)],a.prototype,"columns",void 0),D([t.Property(!0)],a.prototype,"allowKeyboard",void 0),D([t.Collection([],w)],a.prototype,"stackedHeaders",void 0),D([t.Complex({},c)],a.prototype,"swimlaneSettings",void 0),D([t.Complex({},u)],a.prototype,"cardSettings",void 0),D([t.Property(!0)],a.prototype,"allowDragAndDrop",void 0),D([t.Property(!1)],a.prototype,"enableTooltip",void 0),D([t.Property()],a.prototype,"tooltipTemplate",void 0),D([t.Event()],a.prototype,"actionBegin",void 0),D([t.Event()],a.prototype,"actionComplete",void 0),D([t.Event()],a.prototype,"actionFailure",void 0),D([t.Event()],a.prototype,"created",void 0),D([t.Event()],a.prototype,"dataBinding",void 0),D([t.Event()],a.prototype,"dataBound",void 0),D([t.Event()],a.prototype,"cardClick",void 0),D([t.Event()],a.prototype,"cardDoubleClick",void 0),D([t.Event()],a.prototype,"columnRendered",void 0),D([t.Event()],a.prototype,"cardRendered",void 0),D([t.Event()],a.prototype,"dragStart",void 0),D([t.Event()],a.prototype,"drag",void 0),D([t.Event()],a.prototype,"dragStop",void 0),a=D([t.NotifyPropertyChanges],a)}(t.Component);return e.Kanban=T,e.actionBegin="actionBegin",e.actionComplete="actionComplete",e.actionFailure="actionFailure",e.cardClick="cardClick",e.cardDoubleClick="cardDoubleClick",e.cardRendered="cardRendered",e.columnRendered="columnRendered",e.dataBinding="dataBinding",e.dataBound="dataBound",e.dragStart="dragStart",e.drag="drag",e.dragStop="dragStop",e.documentClick="document-click",e.contentReady=l,e.dataReady=o,e.bottomSpace=25,e.cardSpace=16,e.toggleWidth=50,e}({},ej.base,ej.popups,ej.data,ej.navigations),this.ejs=ej;
//# sourceMappingURL=ej2-kanban.min.js.map
